
# bank36 전반적으로 M0 ~ M2에 비해 M3 ~ M5기간의 데이터 건수 및 금액이 줄어듦
SELECT *  FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
  WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
  WHERE BDAY_CUST_ID =10)
 AND IS_CONSENT=1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
 AND TRANS_TYPE =3
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 10), INTERVAL 1 MONTH)) AND
                                                 (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 10)

                                                 
                                                 
SELECT * FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
  WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
  WHERE BDAY_CUST_ID = 10)
 AND IS_CONSENT=1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
 AND TRANS_TYPE =3
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 10), INTERVAL 6 MONTH)) AND
                                                 (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 10), INTERVAL 5 MONTH))
                                                 
                                                 
                                                 
# 급여이체금액이 더블 카운팅 되었는가?
SELECT *  FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
  WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
  WHERE BDAY_CUST_ID =13)
 AND IS_CONSENT=1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
 AND TRANS_TYPE =3
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 13), INTERVAL 1 MONTH)) AND
                                                 (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 13)     
                                                 
                                                 
SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 13)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)
        AND TRANS_TYPE =3
        AND (TRANS_MEMO LIKE '%급여%' OR TRANS_MEMO LIKE '%월급%' OR TRANS_MEMO LIKE '%성과급%' OR TRANS_MEMO LIKE '%인센티브%' OR TRANS_MEMO LIKE '%보너스%' OR TRANS_MEMO LIKE '%상여%' OR TRANS_MEMO LIKE '%연차%' OR TRANS_MEMO LIKE '%연말정산%' OR TRANS_MEMO LIKE '%소급%')
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 13), INTERVAL 1 MONTH)) AND
                                                 (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 13);
                                                 
                                                
                                                
                                                
# 14
SELECT *
FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST mbadt
LEFT OUTER JOIN MD_BANK_ACCOUNTS mba 
ON mbadt.BANK_ACCOUNTS_ID = mba.ID
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS
        WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 438)
        AND IS_CONSENT = 1)
#AND mbadt.TRANS_TYPE =2
AND mba.ACCOUNT_TYPE = 1001
AND mba.ACCOUNT_STATUS = 1
AND mbadt.BALANCE_AMT = 0
AND mbadt.TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 438), INTERVAL 3 MONTH)) AND
                                                          (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 438), INTERVAL 2 MONTH));

                                 
       
                                                         

################################
# 생보 연금 금액 계산 
SELECT SUM(A.TRANS_AMT)/2 FROM 
(SELECT TRANS_DTIME,TRANS_AMT,TRANS_MEMO FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS
							WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN
												WHERE BDAY_CUST_ID IN (SELECT mut.BDAY_CUST_ID  FROM MD_INSU_INSURANCES_BASIC miib , MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INSU_INSURANCES_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mut.BDAY_CUST_ID = bc.ID
																		AND TRUNCATE((TO_DAYS(NOW()) - TO_DAYS(bc.BIRTH_DD)) / 365, 0)>=55
																		AND mii.INSU_TYPE IN (09,10)
																		AND mut.BDAY_CUST_ID = 1035))
							AND ACCOUNT_TYPE = 1001)
AND TRANS_TYPE =3
AND TRANS_MEMO NOT LIKE '%급여%' AND TRANS_MEMO NOT LIKE '%국민연금%' AND TRANS_MEMO NOT LIKE '%퇴직연금%'
AND TRANS_MEMO REGEXP '연금|교보생|흥국생|삼성생|신한라이프|라이나생|IBK연금|농협생|처브라이프생|메트라이프|DB|동양생|ABL생|하나생|미래에셋생보|AIA생|교보라이프|푸르덴셜생|우체국보험|BNP파리바카디프생|KDB생|DGB생|KB생|푸본현대생|한화생|AIG손|현대해상|롯데손|AXA손|메리츠화재|한화손|DB손|삼성화재|MG손|캐롯손|KB손|흥국화재|농협손'
ORDER BY TRANS_DTIME) A,
(SELECT TRANS_DTIME,TRANS_AMT,TRANS_MEMO FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS
							WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN
												WHERE BDAY_CUST_ID IN (SELECT mut.BDAY_CUST_ID  FROM MD_INSU_INSURANCES_BASIC miib , MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INSU_INSURANCES_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mut.BDAY_CUST_ID = bc.ID
																		AND TRUNCATE((TO_DAYS(NOW()) - TO_DAYS(bc.BIRTH_DD)) / 365, 0)>=55
																		AND mii.INSU_TYPE IN (09,10)
																		AND mut.BDAY_CUST_ID = 1035))
							AND ACCOUNT_TYPE = 1001)
AND TRANS_TYPE =3
AND TRANS_MEMO NOT LIKE '%급여%' AND TRANS_MEMO NOT LIKE '%국민연금%' AND TRANS_MEMO NOT LIKE '%퇴직연금%'
AND TRANS_MEMO REGEXP '연금|교보생|흥국생|삼성생|신한라이프|라이나생|IBK연금|농협생|처브라이프생|메트라이프|DB|동양생|ABL생|하나생|미래에셋생보|AIA생|교보라이프|푸르덴셜생|우체국보험|BNP파리바카디프생|KDB생|DGB생|KB생|푸본현대생|한화생|AIG손|현대해상|롯데손|AXA손|메리츠화재|한화손|DB손|삼성화재|MG손|캐롯손|KB손|흥국화재|농협손'
ORDER BY TRANS_DTIME) B
WHERE ((MONTH(A.TRANS_DTIME) = MONTH(B.TRANS_DTIME)+1) OR (MONTH(A.TRANS_DTIME)+1 = MONTH(B.TRANS_DTIME)) OR (MONTH(A.TRANS_DTIME) = MONTH(B.TRANS_DTIME)-11)OR (MONTH(A.TRANS_DTIME)-11 = MONTH(B.TRANS_DTIME)))
AND A.TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1035), INTERVAL 6 MONTH)) AND
                                                (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1035)
AND IF(A.TRANS_MEMO LIKE "%개인연금%",'개인연금',A.TRANS_MEMO) = IF(B.TRANS_MEMO LIKE "%개인연금%",'개인연금',B.TRANS_MEMO)
AND ABS(A.TRANS_AMT  - B.TRANS_AMT) <= 50000
GROUP BY IF(A.TRANS_MEMO LIKE "%개인연금 %",'개인연금',A.TRANS_MEMO), FLOOR(A.TRANS_AMT / 10000)
HAVING  COUNT(*)> 1;
##############################
#투자증권 연금 금액 계산 
SELECT SUM(A.TRANS_AMT)/2 FROM 
(SELECT TRANS_DTIME,TRANS_AMT,TRANS_MEMO FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS
							WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN
												WHERE BDAY_CUST_ID IN (SELECT mut.BDAY_CUST_ID  FROM MD_INVEST_ACCOUNTS_BASIC miib , MD_INVEST_ACCOUNTS mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INVEST_ACCOUNTS_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mut.BDAY_CUST_ID = bc.ID
																		AND TRUNCATE((TO_DAYS(NOW()) - TO_DAYS(bc.BIRTH_DD)) / 365, 0)>=55
																		AND mii.ACCOUNT_TYPE IN (105)
																		AND mut.BDAY_CUST_ID = 645))
							AND ACCOUNT_TYPE = 1001)
AND TRANS_TYPE =3
AND TRANS_MEMO NOT LIKE '%급여%' AND TRANS_MEMO NOT LIKE '%국민연금%' AND TRANS_MEMO NOT LIKE '%퇴직연금%'
AND TRANS_MEMO REGEXP 'DB금융투자|DS투자증권|KB증권|케이비증권|NH투자증권|골드만삭스증권|교보증권|노무라금융투자|다올투자증권|다이와증권캐피탈마켓코리아|대신증권|도이치증권|리딩투자증권|맥쿼리증권|메리츠증권|메릴린치인터내셔날엘엘씨증권|모간스탠리인터내셔날증권|미래에셋증권|미즈호증권아시아|부국증권|비엔케이투자증권|비엔피파리바증권|삼성증권|상상인증권|신영증권|신한금융투자|씨엘에스에이코리아증권|씨지에스씨아이엠비증권|씨티그룹글로벌마켓증권|아이비케이투자증권|아이엔지증권|에스케이증권|유비에스증권리미티드|유안타증권|유진투자증권|유진증권|유화증권|이베스트투자증권|제이피모간증권|초상증권|카카오페이증권|케이아이디비채권중개|케이알투자증권|케이프투자증권|코리아에셋투자증권|크레디아그리콜아시아증권|레디트스위스증권|키움증권|토스증권|하나증권|하이투자증권|한국스탠다드차타드증권|한국아이엠씨증권|한국에스지증권|한국투자증권|한국포스증권|한양증권|한화투자증권|현대차증권|홍콩상하이증권|흥국증권|IBK투자증권|한국증권금융|DB금융투자|BNK투자증권|우리종합금융|다올투자증권|KTB투자증권|SK증권|MS투자증권'
ORDER BY TRANS_DTIME) A,
(SELECT TRANS_DTIME,TRANS_AMT,TRANS_MEMO FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS
							WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN
												WHERE BDAY_CUST_ID IN (SELECT mut.BDAY_CUST_ID  FROM MD_INVEST_ACCOUNTS_BASIC miib , MD_INVEST_ACCOUNTS mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INVEST_ACCOUNTS_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mut.BDAY_CUST_ID = bc.ID
																		AND TRUNCATE((TO_DAYS(NOW()) - TO_DAYS(bc.BIRTH_DD)) / 365, 0)>=55
																		AND mii.ACCOUNT_TYPE IN (105)
																		AND mut.BDAY_CUST_ID = 645))
							AND ACCOUNT_TYPE = 1001)
AND TRANS_TYPE =3
AND TRANS_MEMO NOT LIKE '%급여%' AND TRANS_MEMO NOT LIKE '%국민연금%' AND TRANS_MEMO NOT LIKE '%퇴직연금%'
AND TRANS_MEMO REGEXP 'DB금융투자|DS투자증권|KB증권|케이비증권|NH투자증권|골드만삭스증권|교보증권|노무라금융투자|다올투자증권|다이와증권캐피탈마켓코리아|대신증권|도이치증권|리딩투자증권|맥쿼리증권|메리츠증권|메릴린치인터내셔날엘엘씨증권|모간스탠리인터내셔날증권|미래에셋증권|미즈호증권아시아|부국증권|비엔케이투자증권|비엔피파리바증권|삼성증권|상상인증권|신영증권|신한금융투자|씨엘에스에이코리아증권|씨지에스씨아이엠비증권|씨티그룹글로벌마켓증권|아이비케이투자증권|아이엔지증권|에스케이증권|유비에스증권리미티드|유안타증권|유진투자증권|유진증권|유화증권|이베스트투자증권|제이피모간증권|초상증권|카카오페이증권|케이아이디비채권중개|케이알투자증권|케이프투자증권|코리아에셋투자증권|크레디아그리콜아시아증권|레디트스위스증권|키움증권|토스증권|하나증권|하이투자증권|한국스탠다드차타드증권|한국아이엠씨증권|한국에스지증권|한국투자증권|한국포스증권|한양증권|한화투자증권|현대차증권|홍콩상하이증권|흥국증권|IBK투자증권|한국증권금융|DB금융투자|BNK투자증권|우리종합금융|다올투자증권|KTB투자증권|SK증권|MS투자증권'
ORDER BY TRANS_DTIME) B
WHERE ((MONTH(A.TRANS_DTIME) = MONTH(B.TRANS_DTIME)+1) OR (MONTH(A.TRANS_DTIME)+1 = MONTH(B.TRANS_DTIME)) OR (MONTH(A.TRANS_DTIME) = MONTH(B.TRANS_DTIME)-11)OR (MONTH(A.TRANS_DTIME)-11 = MONTH(B.TRANS_DTIME)))
AND A.TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 645), INTERVAL 6 MONTH)) AND
                                                (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 645)
AND IF(A.TRANS_MEMO LIKE "%개인연금%",'개인연금',A.TRANS_MEMO) = IF(B.TRANS_MEMO LIKE "%개인연금%",'개인연금',B.TRANS_MEMO)
AND ABS(A.TRANS_AMT  - B.TRANS_AMT) <= 50000
GROUP BY IF(A.TRANS_MEMO LIKE "%개인연금%",'개인연금',A.TRANS_MEMO), FLOOR(A.TRANS_AMT / 10000)
HAVING  COUNT(*)> 1;
##############################

### 순 출금 
SELECT CSS_BANK_30(1024)
, CSS_BANK_31(1024)
, CSS_BANK_32(1024)
, CSS_BANK_33(1024)
, CSS_BANK_34(1024)
, CSS_BANK_35(1024);

### 순 입금 
SELECT CSS_BANK_36(1024)
, CSS_BANK_37(1024)
, CSS_BANK_38(1024)
, CSS_BANK_39(1024)
, CSS_BANK_40(1024)
, CSS_BANK_41(1024);

### 급여 금액 
SELECT CSS_BANK_42(1024)
, CSS_BANK_43(1024)
, CSS_BANK_44(1024)
, CSS_BANK_45(1024)
, CSS_BANK_46(1024)
, CSS_BANK_47(1024);



#급여금액##################################### 
SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)
        AND TRANS_TYPE =3
        AND (TRANS_MEMO LIKE '%급여%' OR TRANS_MEMO LIKE '%월급%' OR TRANS_MEMO LIKE '%성과급%' OR TRANS_MEMO LIKE '%인센티브%' OR TRANS_MEMO LIKE '%보너스%' OR TRANS_MEMO LIKE '%상여%' OR TRANS_MEMO LIKE '%연차%' OR TRANS_MEMO LIKE '%연말정산%' OR TRANS_MEMO LIKE '%소급%')
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH)) AND
                                                 (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024);                                            
                                                 
# 입금금액 #####################################
SELECT  ROUND(
 (SELECT SUM(TRANS_AMT) FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
        WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =3
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH)) AND
                                                        (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024))
-
(SELECT IFNULL(SUM(TRANS_AMT),0) FROM
(SELECT DISTINCT , B.TRANS_AMT, B.TRANS_DTIME-- A.BANK_ACCOUNTS_ID,B.BANK_ACCOUNTS_ID, A.TRANS_DTIME, B.TRANS_DTIME,A.TRANS_AMT,B.TRANS_AMT,A.TRANS_TYPE,B.TRANS_TYPE
 FROM
 (SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
        WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =2
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH)) AND
                                                        (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024)) A, -- 출금
 (SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
        WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =3
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH)) AND
                                                        (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024)) B -- 입금
 WHERE A.TRANS_AMT = B.TRANS_AMT
 AND A.BANK_ACCOUNTS_ID != B.BANK_ACCOUNTS_ID
 AND DATE_FORMAT(A.TRANS_DTIME,"%Y-%m-%d") = DATE_FORMAT(B.TRANS_DTIME,"%Y-%m-%d")) AS C)) AS ALL_AMT;

 # 총 입금 M1 기준################################
SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
				AND TRANS_MEMO NOT LIKE '%체크%'
				AND TRANS_MEMO NOT LIKE '%후불교통%'
				AND TRANS_MEMO NOT LIKE '%교통카드%'
				AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =3
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 2 MONTH)) AND
                                                        (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH))
# 총 출금 M1 기준 ################################################
                                                        
SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
        WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =2
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 2 MONTH)) AND
                                                        (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID
                                                        

# 순 입금 내역(조정내역을 제외한 입금 내역)
SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
        WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =3
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH)) AND
                                                        (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024)
		AND ID NOT IN (
SELECT DISTINCT  -- , A.BANK_ACCOUNTS_ID, B.BANK_ACCOUNTS_ID, A.TRANS_AMT, B.TRANS_AMT, A.TRANS_DTIME, B.TRANS_DTIME, A.TRANS_MEMO, B.TRANS_MEMO-- A.BANK_ACCOUNTS_ID,B.BANK_ACCOUNTS_ID, A.TRANS_DTIME, B.TRANS_DTIME,A.TRANS_AMT,B.TRANS_AMT,A.TRANS_TYPE,B.TRANS_TYPE
 FROM
 (SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
        WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =2
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH)) AND
                                                        (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024)) A, -- 출금
 (SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
        WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 1024)
        AND IS_CONSENT =1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND TRANS_MEMO NOT LIKE '%체크%'
							AND TRANS_MEMO NOT LIKE '%후불교통%'
							AND TRANS_MEMO NOT LIKE '%교통카드%'
							AND TRANS_MEMO NOT LIKE '%교통이용%'
        AND TRANS_TYPE =3
        AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024), INTERVAL 1 MONTH)) AND
                                                        (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1024)) B -- 입금
 WHERE FLOOR(A.TRANS_AMT) = FLOOR(B.TRANS_AMT)
 AND A.BANK_ACCOUNTS_ID != B.BANK_ACCOUNTS_ID
 AND DATE_FORMAT(A.TRANS_DTIME,"%Y-%m-%d") = DATE_FORMAT(B.TRANS_DTIME,"%Y-%m-%d"));

        
        
# DB 확인
select * from BDAY_CUST bc 
where 1=1
and id in (268)
;

select * from MD_CARD_APPROVAL_DOMESTIC_HIST mcadh
where 1=1
and CRT_ID IN ('BT77RzWfMuZYZzmB')
;

# 소비성지출 

SELECT SUM(PAID_AMT) FROM betterday_db.MD_CARD_BILLS_DETAIL
WHERE CRT_ID IN (SELECT CRT_ID FROM betterday_db.MD_CARD_CARDS
					WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
										WHERE BDAY_CUST_ID =10) # cust id
					AND IS_CONSENT = 1)		# where2 isconsent
AND PAID_DTIME BETWEEN '2022-07-01' AND '2022-07-31'



SELECT SUM(PAID_AMT) FROM betterday_db.MD_CARD_BILLS_DETAIL
        WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
												WHERE BDAY_CUST_ID = 10) # cust id
        AND PAID_DTIME BETWEEN '2022-07-01' AND '2022-07-31'

       
        
        
SELECT * FROM MD_CARD_BILLS_DETAIL

SELECT * FROM MD_CARD_DETAIL


select * from BDAY_CUST bc where MY_CODE like 'FXINSA';

                                                       
SELECT * FROM MD_BANK_ACCOUNTS
 WHERE  TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN
                      WHERE BDAY_CUST_ID = 268)
 AND IS_CONSENT=1
 AND ACCOUNT_TYPE IN (1002, 1003) AND ACCOUNT_STATUS =1;

SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_DETAIL 
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN 
															WHERE BDAY_CUST_ID = 268)
															AND ACCOUNT_TYPE IN (1002,1003)
															AND IS_CONSENT=1);	



#### 가처분소득
## 근로가처분소득
SELECT 2*(IFNULL(CSS_Bank_42(268),0)+IFNULL(CSS_Bank_43(268),0)+IFNULL(CSS_Bank_44(268),0)+IFNULL(CSS_Bank_45(268),0)+IFNULL(CSS_Bank_46(268),0)+IFNULL(CSS_Bank_47(268),0));

SELECT CSS_CASH_15(268);

## 연금가처분소득
SELECT 2*(IFNULL(CSS_Bank_48(268),0)+IFNULL(CSS_Bank_51(268),0)+IFNULL(CSS_Bank_52(268),0)+IFNULL(CSS_IRP_7(268),0));

SELECT CSS_CASH_16(268)


#### [ 2×(Bank135+Bank136+ins29+Ins30+Card110)+Card111] - 부채상환 

SELECT CSS_BANK_96(10), CSS_BANK_136_MON(10), CSS_INS_29_MON(10) ,CSS_INS_30_MON(10) ,CSS_CARD_108(10)/6 , CSS_CARD_109(10)/6  , CSS_CARD_111(10)/12
# 135의 한달 - 96, card110 = 109+108, 109/6 + 108/6으로 계산 , CARD111은 연단위라서 /12 

# SUM(-1*BALANCE_AMT)/COUNT(*)
SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST mbadth  
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS 
                                                        WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN 
                                                                                                WHERE BDAY_CUST_ID=10)
                                                        AND IS_CONSENT =1
                                                        AND ACCOUNT_TYPE = 1001 
                                                        AND ACCOUNT_STATUS=1)
AND BALANCE_AMT <0
AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 10), INTERVAL 1 MONTH)) AND
                                                (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 10);
   

# 한달간 bank trans hist 횟수가 3000번 이상 - 하루에 100번?!
# trans memo 가 '이기용'씨로 뜨는 현상이 다수 발                                            
SELECT COUNT(*) FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 4160)) 
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 4160), INTERVAL 2 MONTH)) AND
                                                 (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 4160), INTERVAL 1 MONTH))
AND TRANS_MEMO LIKE '이기용'
-- GROUP BY BANK_ACCOUNTS_ID , TRANS_DTIME , TRANS_AMT , TRANS_MEMO , TRANS_CLASS 
-- HAVING COUNT(*) >1
                                                

SELECT COUNT(*) FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST 
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 4160)) 
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 4160), INTERVAL 6 MONTH)) AND
                                                 (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 4160), INTERVAL 5 MONTH))                                                
AND TRANS_MEMO LIKE '이기용' 




######### bank_deposit_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(mbadth.TRANS_DTIME), MIN(mbadth.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(mbadth.TRANS_DTIME),MAX(mbadth.TRANS_DTIME)) AS TIME_DIFF FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST mbadth , MD_BANK_ACCOUNTS mba , MD_USER_TOKEN mut 
WHERE mbadth.BANK_ACCOUNTS_ID = mba.ID AND mba.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

######### bank_invest_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(mbaith.TRANS_DTIME), MIN(mbaith.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(mbaith.TRANS_DTIME),MAX(mbaith.TRANS_DTIME)) AS TIME_DIFF FROM MD_BANK_ACCOUNTS_INVEST_TRANS_HIST mbaith , MD_BANK_ACCOUNTS mba , MD_USER_TOKEN mut 
WHERE mbaith.BANK_ACCOUNTS_ID = mba.ID AND mba.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

######### bank_loan_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(mbalth.TRANS_DTIME), MIN(mbalth.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(mbalth.TRANS_DTIME),MAX(mbalth.TRANS_DTIME)) AS TIME_DIFF FROM MD_BANK_ACCOUNTS_LOAN_TRANS_HIST mbalth , MD_BANK_ACCOUNTS mba , MD_USER_TOKEN mut 
WHERE mbalth.BANK_ACCOUNTS_ID = mba.ID AND mba.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

######### BANK_IRP_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(mbith.TRANS_DTIME), MIN(mbith.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(mbith.TRANS_DTIME),MAX(mbith.TRANS_DTIME)) AS TIME_DIFF FROM MD_BANK_IRPS_TRANSACTIONS_HIST mbith, MD_BANK_IRPS mbi  , MD_USER_TOKEN mut 
WHERE mbith.BANK_IRPS_ID  = mbi.ID AND mbi.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

######### INSU_IRPS_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(miith.TRANS_DTIME), MIN(miith.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(miith.TRANS_DTIME),MAX(miith.TRANS_DTIME)) AS TIME_DIFF FROM MD_INSU_IRPS_TRANSACTIONS_HIST miith , MD_INSU_IRPS mii , MD_USER_TOKEN mut 
WHERE miith.INSU_IRPS_ID  = mii.ID AND mii.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

######### INSU_LOANS_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(milth.TRANS_DTIME), MIN(milth.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(milth.TRANS_DTIME),MAX(milth.TRANS_DTIME)) AS TIME_DIFF FROM MD_INSU_LOANS_TRANS_HIST milth , MD_INSU_LOANS mil , MD_USER_TOKEN mut 
WHERE milth.INSU_LOANS_ID  = mil.ID AND mil.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

######### INVEST_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(miath.TRANS_DTIME), MIN(miath.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(miath.TRANS_DTIME),MAX(miath.TRANS_DTIME)) AS TIME_DIFF FROM MD_INVEST_ACCOUNTS_TRANS_HIST miath , MD_INVEST_ACCOUNTS mia , MD_USER_TOKEN mut 
WHERE miath.INVEST_ACCOUNTS_ID  = mia.ID AND mia.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

######### INVEST_irps_trans_hist #########
SELECT mut.BDAY_CUST_ID, MAX(miith.TRANS_DTIME), MIN(miith.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(miith.TRANS_DTIME),MAX(miith.TRANS_DTIME)) AS TIME_DIFF FROM MD_INVEST_IRPS_TRANSACTIONS_HIST miith , MD_INVEST_IRPS mii , MD_USER_TOKEN mut 
WHERE miith.INVEST_IRPS_ID = mii.ID AND mii.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

# BANK_CUST_10
SELECT mut.BDAY_CUST_ID, MAX(mbadth.TRANS_DTIME), MIN(mbadth.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(mbadth.TRANS_DTIME),MAX(mbadth.TRANS_DTIME)) AS TIME_DIFF FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST mbadth , MD_BANK_ACCOUNTS mba , MD_USER_TOKEN mut 
WHERE mbadth.BANK_ACCOUNTS_ID = mba.ID AND mba.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID =10

SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST mbadth , MD_BANK_ACCOUNTS mba , MD_USER_TOKEN mut 
WHERE mbadth.BANK_ACCOUNTS_ID = mba.ID AND mba.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID =10

# CARD_CUST_10
SELECT mut.BDAY_CUST_ID, MAX(mcadh.TRANS_DTIME), MIN(mcadh.TRANS_DTIME), TIMESTAMPDIFF(MONTH,MIN(mcadh.TRANS_DTIME),MAX(mcadh.TRANS_DTIME)) AS TIME_DIFF FROM MD_CARD_APPROVAL_DOMESTIC_HIST mcadh, MD_CARD_CARDS mcc , MD_USER_TOKEN mut 
WHERE mcadh.CARD_CARDS_ID  = mcc.ID AND mcc.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID = 1028

SELECT * FROM MD_CARD_APPROVAL_DOMESTIC_HIST mcadh, MD_CARD_CARDS mcc , MD_USER_TOKEN mut 
WHERE mcadh.CARD_CARDS_ID  = mcc.ID AND mcc.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID = 1028

SELECT * FROM MD_CARD_APPROVAL_DOMESTIC_HIST mcadh 
WHERE CARD_CARDS_ID IN(SELECT ID FROM MD_CARD_CARDS 
						WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN
											WHERE BDAY_CUST_ID =1024))

# CARD APPROVAL DOMESTIC_HIST
SELECT mut.BDAY_CUST_ID, MAX(mcadh.APPROVED_DTIME), MIN(mcadh.APPROVED_DTIME), TIMESTAMPDIFF(MONTH,MIN(mcadh.APPROVED_DTIME),MAX(mcadh.APPROVED_DTIME)) AS TIME_DIFF FROM MD_CARD_APPROVAL_DOMESTIC_HIST mcadh, MD_CARD_CARDS mcc , MD_USER_TOKEN mut 
WHERE mcadh.CARD_CARDS_ID  = mcc.ID AND mcc.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID IN (10, 13, 20, 44, 66, 83, 107, 109, 110, 111, 114, 118, 125, 130, 132, 136, 149, 995, 162, 173, 183, 185, 190, 208, 229, 237, 268, 291, 307, 309, 324, 328, 330, 368, 369, 377, 383, 404, 406, 438, 443, 444, 452, 454, 459, 461, 467, 481, 493, 494, 500, 510, 512, 513, 517, 518, 522, 532, 563, 564, 566, 594, 595, 611, 613, 617, 618, 622, 624, 625, 636, 645, 647, 648, 654, 655, 669, 673, 674, 677, 684, 686, 690, 693, 696, 699, 716, 727, 744, 756, 767, 772, 776, 777, 779, 780, 782, 784, 785, 788, 798, 799, 800, 801, 802, 803, 805, 806, 807, 809, 811, 812, 815, 816, 822, 833, 838, 840, 844, 846, 859, 862, 863, 864, 867, 881, 882, 883, 884, 885, 887, 894, 895, 902, 903, 908, 909, 914, 922, 930, 932, 933, 934, 941, 942, 944, 945, 954, 956, 960, 963, 995, 967, 970, 971, 973, 975, 977, 980, 982, 983, 985, 988, 991, 994, 995, 1000, 1003, 1008, 1010, 1012, 1014, 1015, 1017, 1018, 1024, 1028, 1030, 1035, 1036, 1041, 1043, 1049, 1051, 1059, 1060, 1061, 1062, 1064, 1068, 1071, 1074, 1076, 1078, 1082, 1084, 1085, 1086, 1087, 1089, 1090, 1092, 1093, 1094, 1095, 1098, 1100, 1108, 1120, 1121, 1133, 1135, 1139, 1141, 1146, 1152, 1154, 1156, 1159, 1160, 1161, 1164, 1165, 1167, 1168, 1173, 1174, 1180, 1188, 1189, 1190, 1197, 1199, 1202, 1204, 1205, 1221, 1231, 1232, 1236, 1243, 1244, 1248, 1251, 1258, 1273, 1277, 1280, 1299, 1306, 1307, 1309, 1310, 1314, 1315, 1328, 1333, 1335, 1337, 1341, 1344, 1345, 1346, 1348, 1354, 1359, 1364, 1366, 1376, 1386, 1387, 1388, 1390, 1395, 1408, 1409, 1420, 1433, 1435, 1436, 1438, 1440, 1442, 1446, 1451, 1455, 1467, 1479, 1480, 1483, 1490, 1500, 1503, 1516, 1520, 1530, 1538, 1539, 1542, 1552, 1557, 1559, 1560, 1566, 9950, 1583, 1587, 1588, 1589, 1590, 1591, 1598, 1602, 1607, 1608, 1611, 1612, 1613, 1616, 1622, 1624, 1626, 1636, 1672, 1682, 1688, 1689, 1691, 1694, 1699, 1702, 1703, 1706, 1708, 1710, 1711, 1712, 1713, 1714, 1717, 1718, 1719, 1721, 1725, 1742, 1765, 1786, 1791, 1797, 1808, 1809, 1813, 1815, 1816, 1817, 1820, 1822, 1824, 1825, 1826, 1835, 1836, 1854, 1856, 1866, 1871, 1875, 1880, 1887, 1891, 1896, 1900, 1902, 1906, 1937, 1946, 1953, 1960, 1961, 1962, 1963, 1965, 1967, 1993, 1997, 1998, 2002, 2003, 2010, 2012, 2014, 2016, 2021, 2024, 2033, 2035, 2039, 2040, 2046, 2058, 2060, 2064, 2073, 2098, 2105, 2109, 2110, 2112, 2114, 2123, 2126, 2127, 2129, 2145, 2146, 2149, 2151, 2153, 2995, 2160, 2207, 2212, 2230, 2231, 2233, 2244, 2246, 2247, 2250, 2254, 2258, 2261, 2267, 2290, 2292, 2293, 2303, 2326, 2341, 2347, 2349, 2359, 2369, 2373, 2385, 2389, 2416, 2421, 2422, 2446, 2448, 2449, 2461, 2462, 2464, 2470, 2489, 2500, 2512, 2521, 2540, 2542, 2546, 2564, 2574, 2577, 2583, 2588, 2603, 2639, 2641, 2644, 2654, 2656, 2683, 2689, 2694, 2714, 2716, 2737, 2790, 2806, 2823, 2849, 2852, 2861, 2876, 2878, 2907, 2975, 3052, 3056, 3063, 3067, 3079, 3080, 3084, 3112, 3139, 3192, 3199, 3205, 3258, 3265, 3268, 3272, 3288, 3289, 3298, 3321, 3327, 3351, 3357, 3377, 3432, 3450, 3462, 3469, 3533, 3594, 3596, 3617, 3618, 3636, 3644, 3654, 3676, 3707, 3735, 3744, 3764, 3765, 3794, 3795, 3813, 3819, 3848, 3907, 3912, 3915, 3995, 3988, 3991, 4019, 4024, 4057, 4071, 4124, 4125, 4150, 4151, 4154, 4220, 4292, 4314, 4320, 4323, 4395, 4396, 4398, 4404, 4416, 4449, 4459, 4518, 4576, 4588, 4605, 4610, 4611, 4612, 4620, 4623, 4625, 4630, 4640, 4652, 4658, 4663, 4676, 4679, 4684, 4700, 4715, 4724, 4730, 4738, 4742, 4751, 4773, 4804, 4836, 4876, 4879, 4886, 4889, 4890, 4900, 4908, 4909, 4932, 4996, 5013, 5047, 5050, 5063, 5065, 5069, 5076, 5078, 5099, 5127, 5131, 5144, 5149, 5153, 5190, 5226, 5250, 5261, 5264, 5274, 5278, 5293, 5310, 5315, 5316, 5319, 5331, 5375, 5394, 5411, 5414, 5477, 5478, 5502, 5508, 5525, 5554, 5560, 5564, 5579, 5587, 5590, 5593, 5609, 5614, 5630, 5644, 5648, 5652, 5663, 5679, 5694, 5698, 5709, 5712, 5713, 5725, 5735, 5746, 5748, 5772, 5784, 5828, 5834, 5837, 5846, 5863, 5916, 5920, 5982, 5985, 6028, 6042, 6057, 6075, 6096, 6110, 6116, 6125, 6127, 6144, 6151, 6159, 6174, 6187, 6188, 6234, 6237, 6260, 6263, 6287, 6303, 6312, 6319, 6337, 6338, 6347, 6364, 6385, 6408, 6414, 6427, 6448, 6460, 6468, 6470, 6507, 6513, 6517, 6518, 6524, 6549, 6594, 6603, 6612, 6635, 6638, 6661, 6671, 6674, 6698, 6773, 6808, 6811, 6820, 6866, 6871, 6873, 6882, 6887, 6909, 6926, 6933, 6938, 6945, 6951, 6956, 6966, 6968, 7002, 7003, 7010, 7021, 7036, 7060, 7061, 7063, 7064, 7092, 7098, 7099, 7108, 7110, 7120, 7129, 7130, 7137, 7146, 7166, 7167, 7168, 7182, 7191, 7193, 7195, 7206, 7235, 7242, 7285, 7288, 7296, 7297, 7299, 7300, 7301, 7302, 7303, 7304, 7305, 7306, 7307, 7308, 7309, 7310, 7311, 7312, 7313, 7314, 7315, 7316, 7317, 7319, 7320, 7323, 7324, 7334, 7338, 7387, 7389, 7400, 7405, 7409, 7410, 7427, 7434, 7437, 7448, 7473, 7475, 7476, 7477, 7485, 7486, 7489, 7494, 7498, 7504, 7507, 7519, 7524, 7531, 7556, 7564, 7577, 7587, 7597, 7608, 7615, 7617, 7620, 7622, 7631, 7638, 7656, 7673, 7701, 7709, 7710, 7722, 7727, 7728, 7764, 7765, 7766, 7769, 7770, 7788, 7790, 7791, 7797, 7798, 7799, 7807, 7814, 7815, 7817, 7820, 7825, 7829, 7831, 7832, 7834, 7837, 7839, 7840, 7843, 7844, 7845, 7846, 7849, 7854, 7858, 7861, 7862, 7864, 7865, 7867, 7868, 7869, 7870, 7871, 7872, 7873, 7874, 7875, 7876, 7877, 7878, 7879, 7881, 7882, 7883, 7885, 7888, 7890, 7891, 7893, 7897, 7901, 7902, 7905, 7909, 7910, 7911, 7913, 7914, 7916, 7918, 7919, 7921, 7922, 7923, 7924, 7925, 7926, 7929, 7930, 7931, 7932, 7933, 7934, 7935, 7936, 7938, 7939, 7940, 7941, 7942, 7944, 7945, 7946, 7947, 7948, 7950, 7951, 7953, 7954, 7955, 7957, 7958, 7960, 7961, 7962, 7995, 7966, 7968, 7969, 7972, 7973, 7974, 7975, 7976, 7978, 7979, 7983, 7985, 7989, 7991, 7992, 7994, 7996, 7999, 8000, 8007, 8017, 8018, 8019, 8020, 8022, 8023, 8026, 8032, 8033, 8034, 8035, 8037, 8038, 8039, 8041, 8042, 8043, 8044, 8045, 8046, 8047, 8048, 8049, 8050, 8053, 8054, 8055, 8056, 8057, 8058, 8059, 8060, 8061, 8062, 8065, 8066, 8071, 8072, 8074, 8075, 8076, 8077, 8080, 8082, 8085, 8087, 8088, 8091, 8092, 8093, 8095, 8098, 8101, 8102, 8104, 8105, 8106, 8107, 8109, 8110, 8111, 8112, 8113, 8116, 8117, 8118, 8120, 8123, 8125, 8135, 8137, 8140, 8141, 8145, 8151, 8152, 8155, 8159, 8160, 8164, 8168, 8169, 8170, 8171, 8173, 8174, 8175, 8176, 8177, 8178, 8180, 8181, 8182, 8185, 8187, 8189, 8190, 8193, 8195, 8197, 8199, 8200, 8201, 8202, 8205, 8206, 8209, 8211, 8212, 8216, 8220, 8224, 8226, 8231, 8232, 8233, 8234, 8235, 8237, 8238, 8239, 8241, 8242, 8244, 8246, 8247, 8251, 8255, 8256, 8259, 8260, 8263, 8264, 8265, 8266, 8268, 8270, 8274, 8275, 8276, 8278, 8279, 8282, 8283, 8286, 8289, 8290, 8292, 8294, 8295, 8299, 8300, 8301, 8305, 8306, 8312, 8313, 8314, 8316, 8318, 8320, 8327, 8328, 8329, 8336, 8339, 8343, 8344, 8345, 8346, 8347, 8348, 8352, 8354, 8355, 8358, 8359, 8363, 8369, 8370, 8371, 8372, 8373, 8374, 8377, 8378, 8379, 8383, 8384, 8392, 8397, 8398, 8399, 8401, 8402, 8406, 8410, 8414, 8416, 8417, 8418, 8419, 8421, 8424, 8429, 8430, 8432, 8436, 8437, 8438, 8439, 8441, 8444, 8445, 8446, 8448, 8449, 8450, 8451, 8452, 8454, 8456, 8457, 8463, 8468, 8469, 8476, 8477, 8478, 8480, 8481, 8485, 8486, 8487, 8495, 8499, 8500, 8502, 8503, 8504, 8506, 8512, 8516, 8517, 8518, 8519, 8522, 8523, 8524, 8526, 8527, 8528, 8529, 8536, 8537, 8538, 8539, 8544, 8553, 8554, 8555, 8557, 8558, 8559, 8569, 8572, 8573, 8576, 8582, 8583, 8594, 8598, 8599, 8600, 8601, 8608, 8612, 8615, 8620, 8621)
GROUP BY mut.BDAY_CUST_ID
HAVING TIME_DIFF < 6;

SELECT mut.BDAY_CUST_ID, MAX(mcadh.APPROVED_DTIME), MIN(mcadh.APPROVED_DTIME), TIMESTAMPDIFF(MONTH,MIN(mcadh.APPROVED_DTIME),MAX(mcadh.APPROVED_DTIME)) AS TIME_DIFF FROM MD_CARD_APPROVAL_DOMESTIC_HIST mcadh, MD_CARD_CARDS mcc , MD_USER_TOKEN mut 
WHERE mcadh.CARD_CARDS_ID  = mcc.ID AND mcc.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID = 1028

# CARD_DOMESCTIC_HIST CHECK
SELECT * FROM MD_CARD_APPROVAL_DOMESTIC_HIST mcadh, MD_CARD_CARDS mcc , MD_USER_TOKEN mut 
WHERE mcadh.CARD_CARDS_ID  = mcc.ID AND mcc.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID = 1028

# CARD_DOMESCTIC CHECK
SELECT * FROM MD_CARD_APPROVAL_DOMESTIC mcad , MD_CARD_CARDS mcc , MD_USER_TOKEN mut 
WHERE mcad.CARD_CARDS_ID  = mcc.ID AND mcc.TOKEN_ID = mut.ID
AND mut.BDAY_CUST_ID = 1028

# CARD BILS HIST CHECK
SELECT mut.BDAY_CUST_ID, MAX(mcbh.PAID_OUT_DATE), MIN(mcbh.PAID_OUT_DATE), TIMESTAMPDIFF(MONTH,MIN(mcbh.PAID_OUT_DATE),MAX(mcbh.PAID_OUT_DATE)) AS TIME_DIFF  FROM MD_CARD_BILLS_HIST mcbh , MD_USER_TOKEN mut 
WHERE mcbh.TOKEN_ID = mut.ID 
AND mut.BDAY_CUST_ID = 1028

# CARD_BILLS_HIST CHECK
SELECT *  FROM MD_CARD_BILLS_HIST mcbh , MD_USER_TOKEN mut 
WHERE mcbh.TOKEN_ID = mut.ID 
AND mut.BDAY_CUST_ID = 1028

# CARD_BILLS CHECK
SELECT *  FROM MD_CARD_BILLS mcb , MD_USER_TOKEN mut 
WHERE mcb.TOKEN_ID = mut.ID 
AND mut.BDAY_CUST_ID = 1028

# 정기전송 동의자
SELECT * FROM MD_CARD_CONSENTS mcc , MD_USER_TOKEN mut
WHERE mcc.TOKEN_ID = mut.ID AND mut.BDAY_CUST_ID =1028;

# 전체에 대한 자산연결 수 확인
SELECT ISCONSENT_BANK_1(8662)+ ISCONSENT_CARD_1(8662)+ ISCONSENT_INS_1(8662)+ ISCONSENT_INV_1(8662)+ ISCONSENT_IRP_1(8662) as ASS_COUNT

# 자산연결 20초과 업권수 4개 이상인 고객 + 자산연결 30초과 업권수 3개 이상인 고객 + welcome 이벤트 동의자 추출
SELECT * FROM (SELECT BC.ID, ISCONSENT_BANK_1(BC.ID)+ ISCONSENT_CARD_1(BC.ID)+ ISCONSENT_INS_1(BC.ID)+ ISCONSENT_INV_1(BC.ID)+ ISCONSENT_IRP_1(BC.ID) as ASS_COUNT, 
IF(ISCONSENT_BANK_1(BC.ID)=0,0,1)+ IF(ISCONSENT_CARD_1(BC.ID)=0,0,1)+ IF(ISCONSENT_INS_1(BC.ID)=0,0,1)+ IF(ISCONSENT_INV_1(BC.ID)=0,0,1)+ IF(ISCONSENT_IRP_1(BC.ID)=0,0,1) as UP_COUNT FROM BDAY_CUST BC
	WHERE BC.ID IN (SELECT cust_id FROM betterday_admin.bo_cust_evnts where evnt_id ='2209002' and is_cmplt is null  and is_trm_agr = 'Y')) AS A
	WHERE (A.ASS_COUNT >20 AND A.UP_COUNT >=4) or (A.ASS_COUNT >30 AND A.UP_COUNT >=3);

# welcome 이벤트 동의자 
SELECT cust_id FROM betterday_admin.bo_cust_evnts where evnt_id ='22	09002' and is_cmplt is null  and is_trm_agr = 'Y'

# 정기전송 동의자
SELECT * FROM MD_CARD_CONSENTS mcc , MD_USER_TOKEN mut
WHERE mcc.TOKEN_ID = mut.ID AND mut.BDAY_CUST_ID =1028;

# invest 테이블을 활용하여 연금(105) 계좌를 가지고 있는지 판단, 이후 products를 보고 보유하고 있는지 판단
SELECT * FROM MD_INVEST_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10) ;
SELECT * FROM MD_INVEST_ACCOUNTS_PRODUCTS WHERE INVEST_ACCOUNTS_ID IN (SELECT ID FROM MD_INVEST_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10) AND ACCOUNT_TYPE =105);

# USD 환율 정보 확인 
select * from BD_EXCHANGE_RATE
where CURRENCY_CODE like 'USD';

##### 보험, 은행, 금투에 존재하는 IRPS의 목록 확인 - CURRENCY_CODE는 존재하지 않음
SELECT * FROM MD_INSU_IRPS WHERE TOKEN_ID IN(SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10);# 보험 
SELECT * FROM MD_INVEST_IRPS WHERE TOKEN_ID IN(SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10);
SELECT * FROM MD_INVEST_IRPS_DETAIL WHERE INVEST_IRPS_ID IN (SELECT ID FROM MD_INVEST_IRPS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10));# 금투
SELECT * FROM MD_BANK_IRPS WHERE TOKEN_ID IN(SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10);
SELECT * FROM MD_BANK_IRPS_DETAIL WHERE BANK_IRPS_ID IN (SELECT ID FROM MD_BANK_IRPS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10))# 은행 

# 연금(account_type=105) 인 계좌 내역 확인 
SELECT * FROM MD_INVEST_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10) and ACCOUNT_TYPE =105;

SELECT * FROM MD_INVEST_ACCOUNTS_PRODUCTS WHERE INVEST_ACCOUNTS_ID IN (SELECT ID FROM MD_INVEST_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10  and ACCOUNT_TYPE =105));
SELECT * FROM MD_INVEST_ACCOUNTS_BASIC_HIST WHERE INVEST_ACCOUNTS_ID IN (SELECT ID FROM MD_INVEST_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10));
SELECT * FROM MD_INVEST_ACCOUNTS_PENSION WHERE INVEST_ACCOUNTS_ID IN (SELECT ID FROM MD_INVEST_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10));
SELECT * FROM MD_INVEST_ACCOUNTS_TRANS_HIST WHERE INVEST_ACCOUNTS_ID IN (SELECT ID FROM MD_INVEST_ACCOUNTS WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 10));

# 연금 계좌 확인 - 최종 납부 일자 
select * from MD_INVEST_ACCOUNTS_PENSION a, MD_INVEST_ACCOUNTS b 
where a.INVEST_ACCOUNTS_ID =b.ID  and b.ID = 10;

# 
SELECT SUM(PAID_AMT * PAID_IN_CNT)
FROM (SELECT*
	FROM (
		SELECT miit.ID, miit.INSU_INSURANCES_ID, miit.TRANS_DATE, miit.CURRENCY_CODE, miit.PAID_AMT, miit.PAID_IN_CNT, mii.INSU_TYPE
		FROM MD_INSU_TRANS_HIST miit, MD_INSU_INSURANCES mii
		WHERE miit.INSU_INSURANCES_ID = mii.ID
		AND INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 1967) AND IS_CONSENT = 1)
		AND INSU_TYPE = '09'
		ORDER BY PAID_IN_CNT DESC
		LIMIT 1000
	) A
	GROUP BY INSU_INSURANCES_ID) B;

# 만료된 연금 계좌에 대한 거래내역은 없기 때문에 trans 테이블에는 존재하지 않는다
# 하지만 basic 테이블에서는 만료된 계좌 또한 존재한다.
SELECT FACE_AMT as PAID_AMT
FROM MD_INSU_INSURANCES_BASIC miib, MD_INSU_INSURANCES mii
WHERE miib.INSU_INSURANCES_ID = mii.ID
AND INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 1967) AND IS_CONSENT = 1)
AND INSU_TYPE = '09'

# 위의 문제를 해결할 수 있는 쿼리 
(SELECT INSU_INSURANCES_ID,SUM(PAID_AMT * PAID_IN_CNT) AS PAID_AMT
FROM (SELECT*
	FROM (
		SELECT miit.ID, miit.INSU_INSURANCES_ID, miit.TRANS_DATE, miit.CURRENCY_CODE, miit.PAID_AMT, miit.PAID_IN_CNT, mii.INSU_TYPE
		FROM MD_INSU_TRANS_HIST miit, MD_INSU_INSURANCES mii
		WHERE miit.INSU_INSURANCES_ID = mii.ID
		AND INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 1967) AND IS_CONSENT = 1)
		AND INSU_TYPE = '09'
		ORDER BY PAID_IN_CNT DESC
		LIMIT 1000
	) A
	GROUP BY INSU_INSURANCES_ID) B)
UNION 
(SELECT INSU_INSURANCES_ID, FACE_AMT as PAID_AMT
FROM MD_INSU_INSURANCES_BASIC miib, MD_INSU_INSURANCES mii
WHERE miib.INSU_INSURANCES_ID = mii.ID
AND INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 1967) AND IS_CONSENT = 1)
AND INSU_TYPE = '09'
AND INSU_INSURANCES_ID NOT IN (SELECT miit.INSU_INSURANCES_ID
FROM MD_INSU_TRANS_HIST miit, MD_INSU_INSURANCES mii
WHERE miit.INSU_INSURANCES_ID = mii.ID
AND INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 1967) AND IS_CONSENT = 1)
AND INSU_TYPE = '09')
);


# 거래 후 계좌 잔액 0인 경우에서 조정횟수에 대한 경우 제외시킨 쿼리 - 59
SELECT 
(SELECT IF((SELECT COUNT(*) FROM  MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS
        WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 995)
        AND IS_CONSENT = 1))=0,NULL,COUNT(DISTINCT date_format(mbadt.TRANS_DTIME, '%Y-%m-%d')))
FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST mbadt
LEFT OUTER JOIN MD_BANK_ACCOUNTS mba 
ON mbadt.BANK_ACCOUNTS_ID = mba.ID
WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM MD_BANK_ACCOUNTS
        WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 995)
        AND IS_CONSENT = 1)
AND mbadt.TRANS_TYPE =2
AND mba.ACCOUNT_TYPE = 1001
AND mba.ACCOUNT_STATUS = 1	
AND mbadt.BALANCE_AMT = 0
AND mbadt.TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 995), INTERVAL 1 MONTH)) AND
                                                          (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 995))
-
(SELECT COUNT(DISTINCT date_format(A.TRANS_DTIME, '%Y-%m-%d')) 
FROM (SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN 
	(SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN 
		(SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 995) 
		AND IS_CONSENT=1
		AND ACCOUNT_TYPE = 1001
		AND ACCOUNT_STATUS = 1)
	AND TRANS_TYPE =2
	AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 995), INTERVAL 1 MONTH)) AND
                                                          (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 995)) A,
(SELECT * FROM MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN 
	(SELECT ID FROM MD_BANK_ACCOUNTS WHERE TOKEN_ID IN 
		(SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 995) 
		AND IS_CONSENT=1
		AND ACCOUNT_TYPE = 1001
		AND ACCOUNT_STATUS = 1)
	AND TRANS_TYPE =3
	AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 995), INTERVAL 1 MONTH)) AND
                                                          (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 995)) B
WHERE FLOOR(A.TRANS_AMT) = FLOOR(B.TRANS_AMT) # 금액같은 것 
 AND NOT (A.BANK_ACCOUNTS_ID = B.BANK_ACCOUNTS_ID)  # 계좌가 다른 것 
 AND (A.BALANCE_AMT=0) # 출금 후 잔액이 0일 경우 - 입금의 경우는 제외(마이너스 통장 혹은 이자 수익 0원이 들어왔을 경우를 제외하기 위해서)
 AND DATE_FORMAT(A.TRANS_DTIME,"%Y-%m-%d") = DATE_FORMAT(B.TRANS_DTIME,"%Y-%m-%d")) as css_bank_59; # 날짜가 동일한 것
 
 
 
#### INSU-49
SELECT COUNT(ID) FROM MD_INSU_INSURANCES
WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
WHERE BDAY_CUST_ID = 7313)
AND IS_CONSENT = 1
AND INSU_TYPE IN (01, 02, 07, 11, 12);

### insu5 - 50
SELECT COUNT(ID) 
FROM MD_INSU_INSURANCES mii
WHERE TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN WHERE BDAY_CUST_ID = 157)
AND IS_CONSENT = 1
AND INSU_TYPE IN (9, 10);

### insu10 - 50
SELECT *
FROM MD_INSU_INSURANCES_BASIC miib 
WHERE INSU_INSURANCES_ID in
	(SELECT INSU_INSURANCES_ID
	FROM MD_INSU_INSURANCES_PAYMENT miip
	WHERE INSU_INSURANCES_ID IN (select ID FROM MD_INSU_INSURANCES mii WHERE INSU_TYPE = '09' AND TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN mut WHERE BDAY_CUST_ID=157)
	and PAY_END_DATE < (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 157)));

SELECT SUM(PAID_AMT*PAID_IN_CNT)
FROM (
	SELECT *
	FROM (
		SELECT miit.ID, miit.INSU_INSURANCES_ID, miit.TRANS_DATE, miit.CURRENCY_CODE, miit.PAID_AMT, miit.PAID_IN_CNT, mii.INSU_TYPE 
		FROM MD_INSU_TRANS_HIST miit
		LEFT OUTER JOIN MD_INSU_INSURANCES mii 
		ON miit.INSU_INSURANCES_ID = mii.ID 
		WHERE INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 157) AND IS_CONSENT = 1)
		AND INSU_INSURANCES_ID NOT IN (SELECT INSU_INSURANCES_ID FROM MD_INSU_INSURANCES_PAYMENT miip WHERE INSU_INSURANCES_ID IN (select ID FROM MD_INSU_INSURANCES mii WHERE INSU_TYPE = '09' AND TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN mut WHERE BDAY_CUST_ID=157) and PAY_END_DATE < (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 157)))
		AND INSU_TYPE = '09'
		ORDER BY miit.TRANS_DATE DESC 
		LIMIT 2000
	) A
	GROUP BY INSU_INSURANCES_ID
) B;

SELECT *
FROM MD_INSU_INSURANCES_TRANSACTIONS miit
WHERE INSU_INSURANCES_ID in
	(SELECT INSU_INSURANCES_ID
	FROM MD_INSU_INSURANCES_PAYMENT miip
	WHERE INSU_INSURANCES_ID IN (select ID FROM MD_INSU_INSURANCES mii WHERE INSU_TYPE = '09' AND TOKEN_ID IN (SELECT ID FROM MD_USER_TOKEN mut WHERE BDAY_CUST_ID=157)
	and PAY_END_DATE < (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 157)));


SELECT * FROM BDAY_CUST 
WHERE ID = 1199;

SELECT CSS_BANK_42(1199),CSS_BANK_43(1199),CSS_BANK_44(1199),CSS_BANK_45(1199),CSS_BANK_46(1199);


# CSS_BANK_42 CHECK
SELECT * FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
  WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
  WHERE BDAY_CUST_ID = 1199)
 AND IS_CONSENT=1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)
							AND (TRANS_MEMO LIKE '%급여%' OR TRANS_MEMO LIKE '%월급%' OR TRANS_MEMO LIKE '%성과급%' OR TRANS_MEMO LIKE '%인센티브%' OR TRANS_MEMO LIKE '%보너스%' OR TRANS_MEMO LIKE '%상여%' OR TRANS_MEMO LIKE '%연차%' OR TRANS_MEMO LIKE '%연말정산%' OR TRANS_MEMO LIKE '%소급%')
 AND TRANS_TYPE =3
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1199), INTERVAL 1 MONTH)) AND
                                                 (SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1199)

# CSS_BANK_44 CHECK
SELECT * FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
  WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
  WHERE BDAY_CUST_ID = 1199)
 AND IS_CONSENT=1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND (TRANS_MEMO LIKE '%급여%' OR TRANS_MEMO LIKE '%월급%' OR TRANS_MEMO LIKE '%성과급%' OR TRANS_MEMO LIKE '%인센티브%' OR TRANS_MEMO LIKE '%보너스%' OR TRANS_MEMO LIKE '%상여%' OR TRANS_MEMO LIKE '%연차%' OR TRANS_MEMO LIKE '%연말정산%' OR TRANS_MEMO LIKE '%소급%')
 AND TRANS_TYPE =3
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1199), INTERVAL 3 MONTH)) AND
                                                 (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1199), INTERVAL 2 MONTH))

# CSS_BANK_45 CHECK
SELECT * FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
  WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN
  WHERE BDAY_CUST_ID = 1199)
 AND IS_CONSENT=1 AND ACCOUNT_TYPE = 1001 AND ACCOUNT_STATUS=1)AND TRANS_MEMO NOT LIKE '%페이%'
							AND (TRANS_MEMO LIKE '%급여%' OR TRANS_MEMO LIKE '%월급%' OR TRANS_MEMO LIKE '%성과급%' OR TRANS_MEMO LIKE '%인센티브%' OR TRANS_MEMO LIKE '%보너스%' OR TRANS_MEMO LIKE '%상여%' OR TRANS_MEMO LIKE '%연차%' OR TRANS_MEMO LIKE '%연말정산%' OR TRANS_MEMO LIKE '%소급%')
 AND TRANS_TYPE =3
 AND TRANS_DTIME BETWEEN (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1199), INTERVAL 4 MONTH)) AND
                                                 (SELECT DATE_SUB((SELECT DATE_ADD(MAX(bclh.CRT_DT), INTERVAL 9 HOUR) FROM BDAY_CUST_LOGIN_HIST bclh WHERE CUST_ID = 1199), INTERVAL 3 MONTH))
                                                 
                                                 
                                                
# 83 - 장프로님 연금보험 
SELECT DISTINCT mii.ID, PROD_NAME FROM MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE mii.TOKEN_ID = mut.ID
																		AND mut.BDAY_CUST_ID= 83
																		AND mii.INSU_TYPE IN (09,10)
																		AND IS_CONSENT =1
																		
SELECT * FROM MD_INSU_INSURANCES_PAYMENT miib , MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INSU_INSURANCES_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mii.INSU_TYPE IN (09,10)
																		AND mut.BDAY_CUST_ID = 83
																		AND IS_CONSENT =1		
																		
SELECT * FROM MD_INSU_INSURANCES_BASIC miib , MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INSU_INSURANCES_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mii.INSU_TYPE IN (09,10)
																		AND mut.BDAY_CUST_ID = 83
																		AND IS_CONSENT =1	

SELECT DISTINCT INSU_INSURANCES_ID, PROD_NAME FROM MD_INSU_INSURANCES_TRANSACTIONS miib , MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INSU_INSURANCES_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mii.INSU_TYPE IN (09,10)
																		AND mut.BDAY_CUST_ID = 83
																		AND IS_CONSENT =1			
																		
																	
SELECT  FROM MD_INSU_TRANS_HIST miib  , MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INSU_INSURANCES_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mii.INSU_TYPE IN (09,10)
																		AND mut.BDAY_CUST_ID = 83
																		AND IS_CONSENT =1	
																		
SELECT DISTINCT INSU_INSURANCES_ID, PROD_NAME FROM MD_INSU_INSURANCES_BASIC_HIST miib , MD_INSU_INSURANCES mii, MD_USER_TOKEN mut, BDAY_CUST bc
																		WHERE miib.INSU_INSURANCES_ID=mii.ID
																		AND mii.TOKEN_ID = mut.ID
																		AND mii.INSU_TYPE IN (09,10)
																		AND mut.BDAY_CUST_ID = 83
																		AND IS_CONSENT =1	
																		
SELECT *#PROD_NAME, SUM(PAID_AMT*PAID_IN_CNT)
	FROM (
		SELECT miit.ID, miit.INSU_INSURANCES_ID,mii.PROD_NAME, miit.TRANS_DATE, miit.CURRENCY_CODE, miit.PAID_AMT, miit.PAID_IN_CNT, mii.INSU_TYPE 
		FROM MD_INSU_TRANS_HIST miit, MD_INSU_INSURANCES mii 
		where miit.INSU_INSURANCES_ID = mii.ID 
		AND INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 83) AND IS_CONSENT = 1)
		AND INSU_TYPE = '10'
	) A
	GROUP BY INSU_INSURANCES_ID
	
SELECT *
	FROM (
		SELECT miit.ID, miit.INSU_INSURANCES_ID, miit.TRANS_DATE, miit.CURRENCY_CODE, miit.PAID_AMT, miit.PAID_IN_CNT, mii.INSU_TYPE 
		FROM MD_INSU_TRANS_HIST miit, MD_INSU_INSURANCES mii 
		WHERE miit.INSU_INSURANCES_ID = mii.ID
		AND INSU_INSURANCES_ID IN (SELECT ID FROM betterday_db.MD_INSU_INSURANCES WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 83) AND IS_CONSENT = 1)
		AND INSU_TYPE IN ('9','10')
		ORDER BY miit.TRANS_DATE DESC
		LIMIT 2000
	) A
	GROUP BY INSU_INSURANCES_ID
	
	
#### 조프로님 금융투자연금 IRP내역이 실제 가격과 차이가 있어 확인하는 쿼리 - 13000원 정도 적게 나온
SELECT * FROM MD_BANK_IRPS_TRANSACTIONS_HIST A, MD_BANK_IRPS B, MD_USER_TOKEN C
WHERE A.BANK_IRPS_ID= B.ID AND B.TOKEN_ID = C.ID
AND C.BDAY_CUST_ID = 268
AND B.IS_CONSENT =1
-- AND A.TRANS_TYPE LIKE '02'
############## 정도 적게 나옴 - 5274731

select 5274731 - 13569; # 5288300, 5261162

SELECT * FROM MD_INVEST_IRPS_DETAIL A, MD_INVEST_IRPS B, MD_USER_TOKEN C
WHERE A.INVEST_IRPS_ID = B.ID 
AND B.TOKEN_ID = C.ID
-- AND EVAL_AMT LIKE '52%'
AND IRP_NAME LIKE '%삼성%'
AND INVEST_IRPS_ID = 348;

SELECT * FROM MD_INVEST_IRPS_BASIC A, MD_INVEST_IRPS B, MD_USER_TOKEN C
WHERE A.INVEST_IRPS_ID = B.ID 
AND B.TOKEN_ID = C.ID
AND INVEST_IRPS_ID = 348
-- AND ((EVAL_AMT LIKE '52%') OR (ACCUM_AMT LIKE '52%'))

SELECT * FROM MD_INVEST_IRPS_TRANSACTIONS_HIST A, MD_INVEST_IRPS B, MD_USER_TOKEN C
WHERE A.INVEST_IRPS_ID = B.ID 
AND B.TOKEN_ID = C.ID
AND INVEST_IRPS_ID = 348
-- AND TRANS_AMT LIKE '52%'

# BDAY_CUST_ID : 8417, ACCUM_AMT : 5274938, EVAL_AMT:5338042,  INVEST_IRPS_ID : 231
SELECT * FROM BDAY_CUST 
WHERE MY_CODE LIKE '%GUEST%'
	
	

SELECT * FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_DETAIL 
 WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
                                                           WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 110)
                                                           AND IS_CONSENT=1
                                                           AND ACCOUNT_STATUS=1
                                                           AND ACCOUNT_TYPE = 1001
                                                           AND IS_MINUS = TRUE)
-- AND BALANCE_AMT <0;
	
SELECT * FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_TRANS_HIST
 WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
                                                           WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = 1590)
                                                           AND IS_CONSENT=1
                                                           AND ACCOUNT_STATUS=1
                                                           AND ACCOUNT_TYPE = 1001
                                                           AND IS_MINUS = TRUE)

SELECT * FROM betterday_db.MD_BANK_ACCOUNTS_DEPOSIT_DETAIL 
 WHERE BANK_ACCOUNTS_ID IN (SELECT ID FROM betterday_db.MD_BANK_ACCOUNTS
                                                           WHERE TOKEN_ID IN (SELECT ID FROM betterday_db.MD_USER_TOKEN WHERE BDAY_CUST_ID = )
                                                           AND IS_CONSENT=1
                                                           AND ACCOUNT_STATUS=1
                                                           AND ACCOUNT_TYPE = 1001
                                                           AND IS_MINUS = TRUE);


	
																		
